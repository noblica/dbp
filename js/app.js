!function(){"use strict";angular.module("test",[])}(),function(){"use strict";function e(e,r){function t(e){e.go("app.home")}e.state("app",{"abstract":!0,controller:"AppController",controllerAs:"app",template:"<ui-view></ui-view>"}).state("app.home",{url:"",controller:"TestController",controllerAs:"vm",templateUrl:"app/TestModule/test.html"}),r.when("",t).when("/",t).otherwise("/error/404"),t.$inject=["$state"]}angular.module("app",["ui.router","ui.bootstrap","ngAnimate","core","pipeline","test"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("core",[])}(),function(){"use strict";angular.module("pipeline",[])}(),function(){"use strict";function e(){function e(){}function r(e){t.localHistoryCollapse=!t.localHistoryCollapse,console.log(t.localHistoryCollapse)}var t=this;t.corelationRegisterCollapse=!1,t.localHistoryCollapse=!0,t.predictionMachinesCollapse=!0,t.toggleLocalHistory=r,e()}angular.module("test").controller("TestController",e),e.$inject=[]}(),function(){"use strict";function e(){function e(){console.log("Layout controller loaded!")}e()}angular.module("app").controller("AppController",e),e.$inject=[]}(),function(){"use strict";function e(e){function r(r,t){l.a=e.getValueOfReg(r),l.b=void 0!==Number(t)?Number(t):l.b,isNaN(t)&&(l.bRegName=t,l.b=e.getValueOfReg(t))}function t(t,f,p){r(t,f);var v=l.cmpResult,d=i(l.a),m=i(l.b),g=null;switch(p){case"mov":e.setValueOfReg(l.aRegName,l.b),v=l.b;break;case"add":v=l.a+l.b,u(!1),a(!1),Math.abs(v)>l.maxValue&&(u(!0),v=o(v)),g=i(v),n(d,m,g)&&a(!0),e.setValueOfReg(l.aRegName,v);break;case"sub":case"cmp":u(!1),a(!1),c(!1),v=o(l.a-l.b),l.b>l.a&&u(!0),l.b===l.a&&c(!0),g=i(v),n(d,m,g)&&a(!0),e.setValueOfReg(l.aRegName,v);break;case"mul":u(!1),a(!1),c(!1),v=l.a*l.b,0===v&&c(!0),Math.abs(v)>l.maxValue&&(u(!0),v=o(v)),g=i(v),n(d,m,g)&&a(!0);break;case"div":a(!1),v=l.a/l.b,g===1/0&&a(!0);break;case"and":v=l.a&l.b,s(!!i(v)),e.setValueOfReg(l.aRegName,v);break;case"or":v=l.a|l.b,s(!!i(v)),e.setValueOfReg(l.aRegName,v);break;case"xor":v=l.a^l.b,s(!!i(v)),e.setValueOfReg(l.aRegName,v);break;case"test":c(!1),s(!1),v=l.a&l.b,0===v&&c(!0),s(!!i(v));break;case"not":v=~l.a,e.setValueOfReg(l.aRegName,v)}return l.cmpResult=v,l.cmpResult}function n(e,r,t){return e===r&&t!==e}function i(e){var r=l.bitSize,t=o(e),n=t.toString(2),i=Number(n.split("").reverse()[r]);return i?i:0}function o(e){return Number(e)&l.maxValue}function c(e){return l.flags.ZF=void 0===e?0===l.cmpResult:e,l.flags}function u(e){return l.flags.CF=void 0===e?l.flags.CF:e,l.flags}function a(e){return l.flags.OF=e,void 0===e&&(l.flags.OF=void 0===e?l.flags.OF:e),l.flags}function s(e){return l.flags.SF=e||l.cmpResult<0||l.cmpResult>l.maxValue,l.flags}var l={flags:{ZF:!1,CF:!1,OF:!1,SF:!1},a:0,aRegName:"",b:0,bRegName:"",cmpResult:0,maxValue:Math.pow(2,16)-1,maxValueSigned:Math.pow(2,15)-1,bitSize:15,compareAndSetFlags:t};return l}angular.module("app").factory("aluService",e),e.$inject=["registerService"]}(),function(){"use strict";function e(e,r,t,n,i,o,c,u,a,s,l,f){function p(e){var r=e.split("\n"),t=g(r);b.codeArray=a.setAndRemoveLabelsFromCodeArray(t),b.pipelineStarted=!0,s.pc=-1,b.stepByStep?(s.setNewPc(),P(s.pc,b.codeArray)):d(b.codeArray)}function v(e){m(e)?(l.flushPipeline(),l.flushPipeline(!1,!1,!1,!0),b.pipelineStarted=!1):h(s.pc,e)}function d(e){var r=f(function(){m(e)?(f.cancel(r),l.flushPipeline(),l.flushPipeline(!1,!1,!1,!0),b.pipelineStarted=!1):h(s.pc,e)},10)}function m(e){return u.instructionsInWB.some(function(e){return"end"===e.operation})}function g(e){var r=e.filter(function(e){return""!==e});return r}function h(e,r,t){R().then(function(){s.setNewPc();var e=P(s.pc,r,t);return e})}function P(r,n,o){return e.parse(r,n,1).then(t.parse).then(i.parse).then(c.parse).then(function(e){console.log(e)})}function R(){return c.pipeThrough().then(i.pipeThrough).then(t.pipeThrough).then(e.pipeThrough)}var b=this;b.codeInput="mov ax, 0\nmov bx, 2\nl1:\nadd ax, 1\ncmp ax, bx\njl l1\nend",b.stepByStep=!1,b.codeArray=[],b.pipelineStarted=!1,b.IFModel=r,b.IDModel=n,b.EXModel=o,b.WBModel=u,b.common=l,b.doPrediction=p,b.goToNextBranchInstruction=v}angular.module("app").controller("CodeInputController",e),e.$inject=["IFService","IFModel","IDService","IDModel","EXService","EXModel","WBService","WBModel","labelService","pcService","common","$interval"]}(),function(){"use strict";function e(){var e={restrict:"E",controller:"CodeInputController",controllerAs:"ci",templateUrl:"app/codeInput/code-input.html"};return e}angular.module("app").directive("codeInput",e),e.$inject=[]}(),function(){"use strict";function e(e,r,t,n){function i(i,o,c,u){void 0===i?(e.flush(),r.flush(),t.flush()):(i&&e.flush(),o&&r.flush(),c&&t.flush(),u&&n.flush())}function o(e){var r=null!==e.firstOperator,t=null!==e.secondOperator;return e.operation+" "+(r?e.firstOperator:"")+(t?", "+e.secondOperator:"")}var c={flushPipeline:i,instructionToText:o};return c}angular.module("core").factory("common",e),e.$inject=["IFModel","IDModel","EXModel","WBModel"]}(),function(){"use strict";function e(e){function r(){i.jmpInstructions=["jmp","je","jz","jne","jnz","jg","jnle","jge","jnl","jl","jnge","jle","jng"]}function t(e){return-1!==i.jmpInstructions.indexOf(e)}function n(r){var t=e.flags;switch(r){case"jmp":return!0;case"je":case"jz":return t.ZF;case"jne":case"jnz":return!t.ZF;case"jg":case"jnle":return!t.ZF&&t.SF===t.OF;case"jge":case"jnl":return t.SF===t.OF;case"jl":case"jnge":return t.SF!==t.OF;case"jle":case"jng":return t.ZF||t.SF!==t.OF}}var i={jmpInstructions:[],isJmpInstruction:t,checkBranchCondition:n};return r(),i}angular.module("core").factory("jmpInstructionService",e),e.$inject=["aluService"]}(),function(){"use strict";function e(){function e(e,r){var t={};t[e.toLowerCase()]=r,n.labelArray.push(t)}function r(e){var r=null;return n.labelArray.some(function(t){return void 0!==t[e]?(r=t,!0):void 0}),r[e]}function t(r){for(var t=r,n=0;n<r.length;){var i=r[n];if(-1!==i.indexOf(":")){var o=i.slice(0,i.indexOf(":"));t.splice(n,1),e(o,n)}else n++}return t}var n={labelArray:[],getAddress:r,setLabelAddress:e,setAndRemoveLabelsFromCodeArray:t};return n}angular.module("core").factory("labelService",e),e.$inject=[]}(),function(){"use strict";function e(){function e(){r.pc+=1,null!==r.overridePc&&(r.pc=r.overridePc,r.overridePc=null)}var r={pc:-1,branchesPredictedTaken:[],overridePc:null,setNewPc:e};return r}angular.module("core").factory("pcService",e),e.$inject=[]}(),function(){"use strict";function e(){function e(){r.currentPc=0,r.instructionsInEX=[],r.writeBackResults=[];var e={currentPc:r.currentPc,instructionSet:r.instructionsInEX,writeBackResults:r.writeBackResults};r.returnPromise.resolve(e)}var r={currentPc:null,returnPromise:null,nextPredictionFalse:!1,instructionsInEX:[],writeBackResults:[],flush:e};return r}angular.module("core").factory("EXModel",e),e.$inject=[]}(),function(){"use strict";function e(e,r,t,n,i,o,c,u){function a(r){return o.currentPc=r.currentPc,o.instructionsInEX=r.instructionSet,o.writeBackResults=[],f(o.instructionsInEX),o.returnPromise=e.defer(),o.returnPromise.promise}function s(e,r){var a=t.checkBranchCondition(e.operation),s=n.getAddress(e.firstOperator),l=o.currentPc+r,f=i.branchesPredictedTaken.indexOf(l);if(o.nextPredictionFalse&&(a=!a),a&&-1===f)return c.flushPipeline(!0,!0),i.overridePc=s,u.updatePredictions(1),!0;if(a&&-1!==f)i.branchesPredictedTaken.splice(f,1),u.updatePredictions(1);else if(a||-1!==f){if(!a&&-1!==f)return c.flushPipeline(!0,!0),i.overridePc=l+1,i.branchesPredictedTaken.splice(f,1),u.updatePredictions(0),!0}else u.updatePredictions(0);return!1}function l(e){o.writeBackResults=v(e)}function f(e){return e.some(function(e,r){var n=e.operation,i=t.isJmpInstruction(n);if(i){var o=s(e,r);return o}l(e)}),o.instructionsInEX}function p(){if(o.returnPromise){var r={currentPc:o.currentPc,instructionSet:o.instructionsInEX,writeBackResults:o.writeBackResults};return o.returnPromise.resolve(r),o.returnPromise.promise}return e.resolve()}function v(e){var t=e.firstOperator,n=e.secondOperator,i=e.operation,c=r.compareAndSetFlags(t,n,i),u={currentPc:o.currentPc,register:e.firstOperator,result:c,operation:i};return o.writeBackResults.push(u),o.writeBackResults}var d={parse:a,pipeThrough:p,parseJumpInstruction:s};return d}angular.module("core").factory("EXService",e),e.$inject=["$q","aluService","jmpInstructionService","labelService","pcService","EXModel","common","predictionMachinesService"]}(),function(){"use strict";function e(){function e(){r.currentPc=0,r.instructionsInID=[];var e={currentPc:r.currentPc,instructionSet:r.instructionsInID};r.returnPromise.resolve(e)}var r={currentPc:null,returnPromise:null,instructionsInID:[],flush:e};return r}angular.module("core").factory("IDModel",e),e.$inject=[]}(),function(){"use strict";function e(e,r){function t(t){return r.currentPc=t.currentPc,r.instructionsInID=o(t.instructionSet),r.returnPromise=e.defer(),r.returnPromise.promise}function n(){if(r.returnPromise){var t={currentPc:r.currentPc,instructionSet:r.instructionsInID};return r.returnPromise.resolve(t),r.returnPromise.promise}return e.resolve()}function i(e){var r=e.replace(",",""),t=r.split(" "),n={operation:t[0].toLowerCase(),firstOperator:void 0===t[1]?null:t[1].toLowerCase(),secondOperator:void 0===t[2]?null:t[2].toLowerCase()};return n}function o(e){var r=[];return e.forEach(function(e){var t=i(e);r.push(t)}),r}var c={parse:t,pipeThrough:n,decodeSingleInstruction:i};return c}angular.module("core").factory("IDService",e),e.$inject=["$q","IDModel"]}(),function(){"use strict";function e(){function e(){r.currentPc=0,r.instructionsInIF=[];var e={currentPc:r.currentPc,instructionSet:r.instructionsInIF};r.returnPromise.resolve(e)}var r={currentPc:null,returnPromise:null,instructionsInIF:[],flush:e};return r}angular.module("core").factory("IFModel",e),e.$inject=[]}(),function(){"use strict";function e(e,r,t,n,i,o,c){function u(t,n,i){r.currentPc=t||0,i=i||1,r.returnPromise=e.defer();var o=r.currentPc,c=r.currentPc+i;p.codeArrayInput=angular.copy(n);var u=n.slice(o,c);return a(u),r.instructionsInIF=u,r.returnPromise.promise}function a(e){for(var i=0;i<e.length;){var u=e[i],a=t.decodeSingleInstruction(u),f=i+r.currentPc,p=n.isJmpInstruction(a.operation);if(p&&c.getCurrentPrediction()){var v=e.length-i-1,d=l(a);if(v>0){var m=s(d,v);e.splice(i,v),e.concat(m)}o.branchesPredictedTaken.push(f),o.overridePc=d+v}i++}return e}function s(e,r){var t=e+r;return p.codeArrayInput.slice(e,t)}function l(e){var r=e.firstOperator;return i.getAddress(r)}function f(){if(r.returnPromise){var t={currentPc:r.currentPc,instructionSet:r.instructionsInIF};return r.returnPromise.resolve(t),r.returnPromise.promise}return e.resolve()}var p={currentPc:null,returnPromise:null,instructionsInIF:[],codeArrayInput:[],parse:u,pipeThrough:f};return p}angular.module("core").factory("IFService",e),e.$inject=["$q","IFModel","IDService","jmpInstructionService","labelService","pcService","predictionMachinesService"]}(),function(){"use strict";function e(){function e(){r.currentPc=0,r.instructionsInWB=[],r.writeBackResults=[],r.returnPromise.resolve()}var r={currentPc:null,returnPromise:null,instructionsInWB:[],writeBackResults:[],flush:e};return r}angular.module("core").factory("WBModel",e),e.$inject=[]}(),function(){"use strict";function e(e,r,t){function n(e){return t.currentPc=e.currentPc,t.instructionsInWB=e.instructionSet,t.writeBackResults=e.writeBackResults,i(e.writeBackResults),t.returnPromise=r.defer(),t.returnPromise.promise}function i(r){r.forEach(function(r){var t=r.register,n=r.result,i=r.operation;o(i)&&e.setValueOfReg(t,n)})}function o(e){return-1===u.indexOf(e)}function c(){return t.returnPromise?(t.returnPromise.resolve(t.writeBackResults),t.returnPromise.promise):r.resolve()}var u=["cmp"],a={parse:n,pipeThrough:c};return a}angular.module("core").factory("WBService",e),e.$inject=["registerService","$q","WBModel"]}(),function(){"use strict";function e(){function e(e){var r=0;return void 0!==t.coreRegisters[e]?r=t.coreRegisters[e]:void 0!==t.otherRegisters[e]?r=t.otherRegisters[e]:t.otherRegisters[e]=0,r}function r(e,r){return void 0!==t.coreRegisters[e]?t.coreRegisters[e]=r:t.otherRegisters[e]=r,e}var t={coreRegisters:{ax:0,bx:0,cx:0,dx:0,sp:0,bp:0,si:0,di:0},otherRegisters:{},getValueOfReg:e,setValueOfReg:r};return t}angular.module("core").factory("registerService",e),e.$inject=[]}(),function(){"use strict";function e(e,r,t){function n(){o.corelationRegister.initializeCR()}function i(){o.corelationRegister.setMaxNumberOfBits(o.corelationRegister.size),o.locationHistoryTable.initializeLHT(),o.predictionMachines.setMachineSize()}var o=this;o.corelationRegister=e,o.locationHistoryTable=r,o.predictionMachines=t,o.updateValues=i,n()}angular.module("app").controller("CorelationRegisterController",e),e.$inject=["corelationRegisterService","localHistoryTableService","predictionMachinesService"]}(),function(){"use strict";function e(){var e={restrict:"E",controller:"CorelationRegisterController",controllerAs:"corReg",templateUrl:"app/corelationRegister/corelation-register.html"};return e}angular.module("app").directive("corelationRegister",e),e.$inject=[]}(),function(){"use strict";function e(){function e(e){var t=e||i.size;r(t)}function r(e){i.value=[];for(var r=0;e>r;r++)i.value[r]=0}function t(e){i.value.shift(),i.value.push(e)}function n(){var e=i.value.join("");return parseInt(e,2)}var i={value:[],size:3,setMaxNumberOfBits:r,shiftWithValue:t,getRegisterValue:n,initializeCR:e};return i}angular.module("app").factory("corelationRegisterService",e),e.$inject=[]}(),function(){function e(e,r){function t(){i.localHistoryTable.initializeLHT()}function n(){i.localHistoryTable.initializeLHT(),i.predictionMachines.setMachineSize()}var i=this;i.localHistoryTable=e,i.predictionMachines=r,i.updateValues=n,t()}angular.module("app").controller("localHistoryTableController",e),e.$inject=["localHistoryTableService","predictionMachinesService"]}(),function(){"use strict";function e(){var e={restrict:"E",controller:"localHistoryTableController",controllerAs:"lht",templateUrl:"app/localHistoryTable/local-history-table.html"};return e}angular.module("app").directive("localHistoryTable",e),e.$inject=[]}(),function(){"use strict";function e(e){function r(){}function t(e){var r=e||u.size;u.value=[],i(r)}function n(e){for(var r=0;e>r;)u.value[r++]=[]}function i(r){var t=Math.pow(2,e.size);n(t),u.value=u.value.map(function(e){for(var t=0;r>t;t++)e[t]=0;return e})}function o(e,r){u.value[e].shift(),u.value[e].push(r)}function c(e){var r=u.value[e].join(""),t=parseInt(r,2);return t}var u={value:[],size:3,setMaxNumberOfBits:i,shiftWithValue:o,getLocalHistoryValue:c,initializeLHT:t};return r(),u}angular.module("app").factory("localHistoryTableService",e),e.$inject=["corelationRegisterService"]}(),function(){"use strict";function e(e,r,t){function n(){i.predictionMachines.setMachineSize()}var i=this;i.numberOfMachines=e.numOfMachines,i.predictionMachines=e,n()}angular.module("app").controller("PredictionMachinesController",e),e.$inject=["predictionMachinesService","corelationRegisterService","localHistoryTableService"]}(),function(){function e(){var e={restrict:"E",controller:"PredictionMachinesController",controllerAs:"pm",templateUrl:"app/predictionMachines/prediction-machines.html"};return e}angular.module("app").directive("predictionMachines",e),e.$inject=[]}(),function(){"use strict";function e(e,r){function t(t,n){t=t||e.size,n=n||r.size,u.numOfMachines=Math.pow(2,t+n),u.value=[];for(var i=0;i<u.numOfMachines;)u.value[i++]=[1,0]}function n(e,r){var t=parseInt(u.value[e].join(""),2),n=Math.pow(2,2)-1;0===r&&t>0?t-=1:1===r&&n>t&&(t+=1);var i=t.toString(2);return u.value[e]=o(i,u.sizeOfMachines).split(""),u.value}function i(){var t=e.getRegisterValue(),n=r.getLocalHistoryValue(t),i=u.value[n].join(""),o=parseInt(i,2);return o>=2}function o(e,r){for(var t="",n=0;r>n;n++)t+="0";return(t+e).slice(-r)}function c(t){var i=e.getRegisterValue(),o=r.getLocalHistoryValue(i);n(o,t),r.shiftWithValue(i,t),e.shiftWithValue(t)}var u={numOfMachines:null,sizeOfMachines:2,value:[],setMachineSize:t,getCurrentPrediction:i,updatePredictions:c};return u}angular.module("app").factory("predictionMachinesService",e),e.$inject=["corelationRegisterService","localHistoryTableService"]}();